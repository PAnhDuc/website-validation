name: Validate Project

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
      # 1. Checkout code t·ª´ repository
      - name: Checkout repository
        uses: actions/checkout@v3

      # 2. Thi·∫øt l·∫≠p Node.js
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 16

      # 3. C√†i ƒë·∫∑t dependencies
      - name: Install dependencies
        run: npm install

      # 4. Ch·∫°y ki·ªÉm tra coding convention
      - name: Run ESLint (Coding Convention)
        run: |
          npm run lint > eslint-report.txt || true
          echo "üõë Coding convention check completed. Checking errors..."
          if grep -q 'error' eslint-report.txt; then
            echo ""
            echo "------------------------------------------"
            echo "‚ö†Ô∏è  Found issues in coding convention:"
            echo "------------------------------------------"
            cat eslint-report.txt
            echo ""
            echo "Please fix these errors before continuing."
            exit 1
          else
            echo "‚úÖ All files passed coding convention checks!"
          fi

      # 5. Ch·∫°y ki·ªÉm tra logic code (Unit Tests)
      - name: Run logic tests (Jest)
        run: |
          npm test || echo "‚ö†Ô∏è Logic test failed. Review test cases!"
